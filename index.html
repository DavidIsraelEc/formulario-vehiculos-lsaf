<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro Vehicular LSAF</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: linear-gradient(135deg, #0d2c46 0%, #1a4d79 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
.container { background-color: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 100%; max-width: 750px; overflow: hidden; padding: 30px; }
input, button { padding: 14px; font-size: 16px; border-radius: 8px; border: 1px solid #ddd; width: 100%; margin-top: 10px; }
button { background: linear-gradient(135deg,#0056b3 0%,#003a75 100%); color:white; border:none; cursor:pointer; font-weight:600; text-transform:uppercase; }
button:hover { background: linear-gradient(135deg,#004494 0%,#002954 100%); }
.hidden { display:none; }
.error { color:#721c24; background:#f8d7da; padding:10px; border-radius:5px; margin-top:10px; }
</style>
</head>
<body>

<div class="container">
  <h2><i class="fas fa-car"></i> Acceso al Formulario</h2>

  <!-- Secci√≥n de acceso -->
  <div id="accessSection">
    <input type="password" id="passwordInput" placeholder="Ingrese la contrase√±a" />
    <button id="checkBtn"><i class="fas fa-unlock"></i> Verificar Acceso</button>
    <p id="accessError" class="error hidden"></p>
  </div>

  <!-- Contenido del formulario -->
  <div id="formContent" class="hidden">
    <h3>‚úÖ Acceso concedido</h3>
    <p>Aqu√≠ ir√≠a tu formulario embebido o el contenido protegido.</p>
  </div>
</div>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwuZVRDOgShaXoDpfNKEG6UvO9FQ_Uh0ULlV9XOvntESC_hR0Xslz-yadDb-CkRolR_/exec"; // Reemplaza con tu nueva URL de Apps Script
let ACTIVE_CODE = null;

// üîπ Cargar contrase√±a desde Google Sheets
async function loadCurrentPassword() {
  try {
    const response = await fetch(SHEET_URL + "?noCache=" + new Date().getTime());
    const data = await response.json();
    console.log("Respuesta Apps Script:", data);
    ACTIVE_CODE = data.password?.trim();
  } catch (error) {
    console.error("Error obteniendo c√≥digo:", error);
    document.getElementById("accessError").textContent = "‚ö†Ô∏è No se pudo cargar la contrase√±a. Intente m√°s tarde.";
    document.getElementById("accessError").classList.remove("hidden");
  }
}

// üîπ Verificar contrase√±a
function checkPassword() {
  const inputPass = document.getElementById("passwordInput").value.trim();
  const errorEl = document.getElementById("accessError");
  errorEl.classList.add("hidden");

  if (!ACTIVE_CODE) {
    errorEl.textContent = "‚ö†Ô∏è No se pudo cargar la contrase√±a. Intente m√°s tarde.";
    errorEl.classList.remove("hidden");
    return;
  }

  console.log("Contrase√±a ingresada:", inputPass);
  console.log("C√≥digo actual recibido:", ACTIVE_CODE);

  if (inputPass === ACTIVE_CODE) {
    document.getElementById("accessSection").classList.add("hidden");
    document.getElementById("formContent").classList.remove("hidden");
  } else {
    errorEl.textContent = "‚ùå Contrase√±a incorrecta";
    errorEl.classList.remove("hidden");
  }
}

// üîπ Inicializar
document.addEventListener("DOMContentLoaded", () => {
  loadCurrentPassword();
  document.getElementById("checkBtn").addEventListener("click", checkPassword);
});
</script>

</body>
</html>

