<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generador de Contraseñas - LSAF</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- Mantenemos todo tu diseño anterior --- */
* { box-sizing: border-box; margin:0; padding:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
body { background: linear-gradient(135deg, #1a4d79 0%, #0d2c46 100%); min-height:100vh; display:flex; justify-content:center; align-items:center; padding:20px; }
.container { background:white; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,.2); width:100%; max-width:500px; overflow:hidden; text-align:center; padding:30px; }
.logo { width:80px; height:80px; border-radius:50%; background:white; padding:10px; box-shadow:0 0 15px rgba(0,0,0,.2); margin:0 auto 20px; }
h1 { color:#2c3e50; margin-bottom:10px; }
p { color:#666; margin-bottom:20px; }
.password-display { background:#f8f9fa; border:2px dashed #0056b3; border-radius:8px; padding:20px; margin:20px 0; font-size:24px; font-weight:bold; color:#0056b3; letter-spacing:2px; }
button { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color:white; border:none; padding:16px; font-size:18px; border-radius:8px; cursor:pointer; width:100%; font-weight:600; transition:all .3s; margin:10px 0; }
button:hover { background: linear-gradient(135deg,#218838 0%,#1e9e8a 100%); transform:translateY(-2px);}
.copy-btn { background: linear-gradient(135deg,#0056b3 0%,#003a75 100%); }
.message { padding:15px; margin:20px 0; border-radius:8px; display:none; }
.success { background-color:#d4edda; color:#155724; border:1px solid #c3e6cb; }
.error { background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
.info { background-color:#e8f4ff; color:#004085; border:1px solid #b8daff; }
</style>
</head>
<body>
<div class="container">
  <img src="https://i.imgur.com/fHV1Qo1.png" alt="Logo LSAF" class="logo">
  <h1>Generador de Contraseñas LSAF</h1>
  <p>Genera contraseñas para el sistema de registro vehicular</p>
  <div class="password-display" id="passwordDisplay">Presiona "Generar" para crear una contraseña</div>
  <button onclick="generatePassword()" id="generateBtn"><i class="fas fa-key"></i> Generar Nueva Contraseña</button>
  <button class="copy-btn" onclick="copyPassword()" id="copyBtn"><i class="fas fa-copy"></i> Copiar Contraseña</button>
  <div id="message" class="message"></div>
</div>

<script>
const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbwjC9OvoHQOqksobwRntn-5GP-DsWLyzIo3SciHVnS5VhirVcdc0iitVKfezUiqH8FO/exec'; // reemplazar por tu URL de Google Apps Script
let currentPassword = '';

function showMessage(text,type){
  const msg=document.getElementById('message');
  msg.textContent=text;
  msg.className='message '+type;
  msg.style.display='block';
  setTimeout(()=>{msg.style.display='none';},4000);
}

function generarPassword() {
    const newPass = 'LSAF' + Math.floor(1000 + Math.random()*9000);
    const callbackName = 'cb_gen_' + Math.random().toString(36).substring(2,15);
    window[callbackName] = function(resp) { console.log('Generado y guardado'); delete window[callbackName]; script.remove(); };
    const script = document.createElement('script');
    script.src = `${WEBAPP_URL}?action=savePassword&password=${newPass}&callback=${callbackName}`;
    script.onerror = () => { alert('Error de conexión'); delete window[callbackName]; script.remove(); };
    document.body.appendChild(script);
    return newPass;
}


function copyPassword(){
  if(!currentPassword){ showMessage('Primero genera una contraseña','error'); return; }
  navigator.clipboard.writeText(currentPassword)
    .then(()=>showMessage('✓ Copiada: '+currentPassword,'success'))
    .catch(()=>showMessage('Error al copiar','error'));
}
</script>
</body>
</html>
